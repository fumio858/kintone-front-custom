(()=>{var e={155:()=>{!function(){"use strict";const e="app_id",t="record_id",n="case_group",o="staff";[22,26,55].includes(kintone.app.getId())&&kintone.events.on(["app.record.create.submit.success","app.record.edit.submit.success"],async r=>{try{const a=r.record,s=kintone.app.getId(),c=r.recordId,i=(a[o]?.value||[]).map(e=>e.name).join(", "),l={[e]:{value:String(s)},[t]:{value:String(c)},[n]:{value:a[n]?.value||""},[o]:{value:i}},d=`${e} = "${s}" and ${t} = "${c}"`,u=await kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:58,query:d});if(u.records.length>0){const e=u.records[0].$id.value;await kintone.api(kintone.api.url("/k/v1/record",!0),"PUT",{app:58,id:e,record:l}),console.log(`ğŸŒ€ æ›´æ–°ã—ã¾ã—ãŸï¼ˆID:${e}ï¼‰`)}else await kintone.api(kintone.api.url("/k/v1/record",!0),"POST",{app:58,record:l}),console.log("âœ… æ–°è¦ç™»éŒ²ã—ã¾ã—ãŸ")}catch(e){console.error("âŒ é›†è¨ˆã‚¢ãƒ—ãƒªç™»éŒ²ã‚¨ãƒ©ãƒ¼:",e)}return r})}()},295:()=>{const e="date",t="title",n="description",o="attendees",r="schedulePanel",a="case_id",s="case_type",c="case_id",i="åˆ‘äº‹äº¤é€šä»¥å¤–",l={22:"åˆ‘äº‹äº‹ä»¶",26:"äº¤é€šäº‹æ•…",55:i};!function(){"use strict";const d=e=>kintone.api.url(e.endsWith(".json")?e:`${e}.json`,!0),u=(e="")=>String(e).replace(/\\/g,"\\\\").replace(/"/g,'\\"');function p(){const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10)}function m(n){const r=n.$id.value,a=n[e]?.value||"â€”",s=n[t]?.value||"(ç„¡é¡Œ)",c=Array.isArray(n[o]?.value)?n[o].value.map(e=>e.name||e.code).join(", "):"â€”",i=document.createElement("div");return Object.assign(i.style,{display:"grid",gridTemplateColumns:"1fr auto",gap:"8px",padding:"6px 8px",alignItems:"center",background:"#fafafa",borderBottom:"dotted 1px #e4e1e1"}),i.innerHTML=`\n      <div>\n        <div style="font-weight:600">${s}</div>\n        <div style="font-size:12px;color:#666">æ—¥ä»˜: ${a} / å‚åŠ : ${c}</div>\n      </div>\n      <a href="${location.origin}/k/45/show#record=${r}" target="_blank">é–‹ã</a>\n    `,i}kintone.events.on(["app.record.detail.show"],async e=>{const t=kintone.app.record.getSpaceElement(r);if(!t)return e;if(!t.dataset.initedSchedulePanel){t.dataset.initedSchedulePanel="1";try{await window.userSchedulePanelInit(t)}catch(e){console.warn("[schedule] auto init failed:",e)}}return e}),window.userSchedulePanelInit=async function(f){const h=kintone.app.record.get(),g=h&&h.record?h.record:{};kintone.app.getId(),h&&h.record&&h.recordId||kintone.app.record.getId(),await async function(f,h){try{if(!(f=function(e){if(e&&1===e.nodeType)return e;const t=document.querySelector('[data-mirror-of="user-js-schedulePanel"]');if(t)return t;const n=kintone.app.record.getSpaceElement(r);if(n)return n;const o=document.querySelector(".ocean-ui-comments-commentform-form");if(o){const e=document.createElement("div");return e.dataset.mirrorOf="user-js-schedulePanel",Object.assign(e.style,{marginTop:"12px",borderTop:"1px dashed #e5e7eb",paddingTop:"12px"}),o.insertAdjacentElement("afterend",e),e}const a=document.querySelector("#record-gaia, .contents-gaia, body"),s=document.createElement("div");return s.dataset.mirrorOf="user-js-schedulePanel",a.appendChild(s),s}(f)))return console.warn("[schedule] mountEl not found");const g=function(){try{const e=kintone.app.getId();if(e)return Number(e)}catch(e){}const e=location.pathname.match(/\/k\/(\d+)\//);return e?Number(e[1]):NaN}(),v=l[g]??i,y=(h?.[c]?.value||"").toString().trim();f.style.display="",f.innerHTML="";const k=document.createElement("div");k.classList.add("k-schedule-panel"),k.style.padding="12px",k.style.background="#f7f9fa",k.style.display="",k.innerHTML='\n      <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">\n        <strong>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç™»éŒ²</strong>\n        <div style="margin-left:auto; display:flex; gap:6px;">\n          <button id="sch-show-list" type="button">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§</button> \x3c!-- NEW --\x3e\n          <button id="sch-clear" type="button">å…¥åŠ›ã‚¯ãƒªã‚¢</button>\n          <button id="sch-close" type="button" aria-label="é–‰ã˜ã‚‹ï¼ˆEscï¼‰">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>\n        </div>\n      </div>\n      <style>\n        button { font-size:13px; }\n        .k-schedule-form-left, .k-schedule-form-right { display:flex; flex-direction:column; gap:8px; }\n        .k-schedule-form-wrapper { display:grid; grid-template-columns: 1fr 260px; gap:12px; }\n        .k-schedule-form-wrapper input[type="text"], .k-schedule-form-wrapper input[type="date"],\n        .k-schedule-form-wrapper textarea, .k-schedule-form-wrapper select {\n          border:1px solid #e3e7e8; border-radius:6px; width:100%; padding:8px; box-sizing:border-box;\n        }\n        .k-schedule-form-left textarea { flex-grow:1; resize:vertical; }\n        .k-schedule-actions button, #sch-clear, #sch-close, #sch-show-list {\n          padding:.5rem .75rem; background:#fff; border-radius:6px; border:1px solid #e3e7e8; font-size:.9rem;\n        }\n        .k-schedule-form-wrapper input:focus, .k-schedule-form-wrapper textarea:focus,\n        .k-schedule-form-wrapper select:focus, .k-schedule-actions button:focus,\n        #sch-clear:focus, #sch-close:focus, #sch-show-list:focus {\n          outline:none; box-shadow:0 0 0 3px rgba(227,231,232,.4); border-color:#e3e7e8;\n        }\n        #sch-create { background-color:#3598db; color:#FFF; width:100%; }\n        #sch-create:hover { background-color:#1182ce; }\n        #sch-close, #sch-clear, #sch-show-list { font-size:12px; padding:6px 10px; }\n        #sch-close:hover, #sch-clear:hover, #sch-show-list:hover { background:#f5f7f8; }\n        @media (max-width:600px){ .k-schedule-form-wrapper { grid-template-columns:1fr; } }\n      </style>\n\n      <div id="sch-list" style="display:none; flex-direction:column; gap:6px; margin-bottom:12px;"></div> \x3c!-- NEW --\x3e\n\n      <div class="k-schedule-form-wrapper">\n        <div class="k-schedule-form-left">\n            <label>äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ« <input id="sch-title" type="text" placeholder="ä¾‹ï¼‰æ‰“ã¡åˆã‚ã›"></label>\n            <label style="display:flex; flex-direction:column; flex-grow:1;">äºˆå®šã®èª¬æ˜ <textarea id="sch-desc" placeholder="äºˆå®šã®è©³ç´°ã‚„ãƒ¡ãƒ¢ã‚’å…¥åŠ›"></textarea></label>\n        </div>\n        <div class="k-schedule-form-right">\n            <label>äºˆå®šæ—¥ï¼ˆçµ‚æ—¥ï¼‰ <input id="sch-date" type="date"></label>\n            <label>å‚åŠ è€…ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰ <select id="sch-users" multiple size="8"></select></label>\n            <div class="k-schedule-actions">\n              <button id="sch-create" type="button">ï¼‹ äºˆå®šã‚’ç™»éŒ²</button>\n            </div>\n        </div>\n      </div>\n    ',f.appendChild(k);const b=k.querySelector("#sch-list"),w=k.querySelector("#sch-show-list"),x=k.querySelector("#sch-date"),E=k.querySelector("#sch-title"),S=k.querySelector("#sch-desc"),$=k.querySelector("#sch-users");x.value=p(),await async function(e){const t=kintone.getLoginUser();e.innerHTML="";const n=document.createElement("option");n.value=t.code,n.textContent=`${t.name}ï¼ˆè‡ªåˆ†ï¼‰`,n.selected=!0,e.appendChild(n);try{let n=0,o=100;for(;;){const r=(await kintone.api(d("/v1/users"),"GET",{offset:n,size:o})).users||[];for(const n of r){if(!n.valid||n.code===t.code)continue;const o=document.createElement("option");o.value=n.code,o.textContent=n.name,e.appendChild(o)}if(r.length<o)break;n+=o}}catch(e){console.warn("ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—å¤±æ•—:",e)}}($);let T=!1;async function _(){b.textContent="èª­è¾¼ä¸­â€¦";const t=await async function(t,n){try{let o="";if(t){const r=u(t);o=`${a} = "${r}"`,n&&(o+=` and ${s} = "${u(n)}"`),o+=` order by ${e} asc`}else o=`order by ${e} desc limit 50`;return(await kintone.api(d("/k/v1/records.json"),"GET",{app:45,query:o})).records||[]}catch(e){return console.error("[schedule] å–å¾—ã‚¨ãƒ©ãƒ¼:",e),[]}}(y,v);if(b.innerHTML="",t.length)for(const e of t)b.appendChild(m(e));else b.textContent=y?"ã“ã®æ¡ˆä»¶ã®äºˆå®šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚":"äºˆå®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚"}w.addEventListener("click",async()=>{"none"===b.style.display?(b.style.display="flex",w.textContent="ä¸€è¦§ã‚’éš ã™",T||(await _(),T=!0)):(b.style.display="none",w.textContent="ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§")}),k.querySelector("#sch-clear").addEventListener("click",()=>{x.value=p(),E.value="",S.value="";const e=kintone.getLoginUser();for(const t of $.options)t.selected=t.value===e.code});const L=k.querySelector("#sch-create");L.addEventListener("click",async()=>{const r=(x.value||"").trim(),i=(E.value||"").trim(),l=(S.value||"").trim(),u=Array.from($.selectedOptions).map(e=>({code:e.value}));if(!r)return alert("äºˆå®šæ—¥ï¼ˆçµ‚æ—¥ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");if(!i)return alert("äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");if(!y)return alert(`æ¡ˆä»¶å´ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€Œ${c}ã€ãŒç©ºã§ã™ã€‚å€¤ã‚’å…¥ã‚Œã¦ã‹ã‚‰ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚`);L.disabled=!0;const p=L.textContent;L.textContent="ç™»éŒ²ä¸­â€¦";try{await async function(e){return kintone.api(d("/k/v1/record"),"POST",{app:45,record:e})}({[e]:{value:r},[t]:{value:i},[n]:{value:l},[o]:{value:u},[a]:{value:y},[s]:{value:v}}),alert("äºˆå®šã‚’ç™»éŒ²ã—ã¾ã—ãŸã€‚"),E.value="",S.value="";const c=kintone.getLoginUser();for(const e of $.options)e.selected=e.value===c.code;"none"!==b.style.display&&await _()}catch(e){console.error("äºˆå®šç™»éŒ²ã‚¨ãƒ©ãƒ¼:",e);const t=e?.message||e?.errors&&JSON.stringify(e.errors)||e?.code||"ä¸æ˜ãªã‚¨ãƒ©ãƒ¼";alert(`äºˆå®šç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n${t}`)}finally{L.disabled=!1,L.textContent=p}});const q=()=>{k.style.display="none",f.dispatchEvent(new CustomEvent("schedulePanel:hidden",{bubbles:!1}))};k.querySelector("#sch-close").addEventListener("click",q);const C=e=>{"Escape"===e.key&&"none"!==k.style.display&&q()};document.addEventListener("keydown",C),f.addEventListener("schedulePanel:hidden",()=>{document.removeEventListener("keydown",C)})}catch(j){console.error("[schedule] initSchedulePanel fatal:",j)}}(f,g)}}()},312:(e,t,n)=>{var o;(o=n(390)).keys().forEach(o)},330:()=>{!function(){"use strict";kintone.events.on("app.record.detail.show",function(e){e.record;let t=!1;return(()=>{const e=document.body;new MutationObserver((e,n)=>{const o=document.querySelector(".ocean-ui-comments-commentform-submit");var r;o&&(n.disconnect(),(r=o).dataset.swalListenerAttached||(r.dataset.swalListenerAttached="true",console.log("setupClickListener: ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šå®Œäº†"),r.addEventListener("click",async e=>{if(console.log("setupClickListener: ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ¤œçŸ¥"),t)return void console.log("setupClickListener: isPopupProcessingãŒtrueã®ãŸã‚å‡¦ç†ã‚¹ã‚­ãƒƒãƒ—");const n=document.querySelector(".ocean-ui-comments-commentform-textarea");if(!n||!n.value.trim())return void console.log("setupClickListener: ã‚³ãƒ¡ãƒ³ãƒˆãŒç©ºã®ãŸã‚å‡¦ç†ã‚¹ã‚­ãƒƒãƒ—");if(!(()=>{const e=kintone.getLoginUser(),t=kintone.app.record.get().record,n=t.main_lawyer.value.map(e=>e.code),o=t.staff.value.map(e=>e.code),r=t.chief.value.map(e=>e.code);return n.includes(e.code)||o.includes(e.code)||r.includes(e.code)})())return void console.log("setupClickListener: æ‹…å½“è€…ã§ãªã„ãŸã‚å‡¦ç†ã‚¹ã‚­ãƒƒãƒ—");e.preventDefault(),e.stopPropagation(),console.log("setupClickListener: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºæº–å‚™"),await(window.Swal?Promise.resolve():new Promise(e=>{const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/sweetalert2@11",t.onload=e,document.head.appendChild(t)}));let o=document.querySelector(".gaia-app-statusbar-statusmenu")?.innerText.replace(/\n/g,"<br>")||"";o=o.replace(/ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å±¥æ­´/g,""),o=o.replace(/ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:/g,"ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼š"),o=o.replace(/ç¾åœ¨ã®ä½œæ¥­è€…:/g,"ç¾åœ¨ã®ä½œæ¥­è€…ï¼š");const a=document.querySelectorAll(".gaia-app-statusbar-action");let s="";a.forEach((e,t)=>{const n=e.querySelector(".gaia-app-statusbar-action-label");let o=n?.innerText;const r=n?.title;if(o){let e="margin: .5rem; border: 1px solid #e3e7e8; background-color: #f7f9fa; box-shadow: 1px 1px 1px #fff inset; color: #3498db;";"ç¾åœ¨ã®ä½œæ¥­è€…ã‚’å¤‰æ›´"===r?(o="ç¾åœ¨ã®ä½œæ¥­è€…ã‚’å¤‰æ›´",e="margin: .5rem; border: 1px solid #e3e7e8; background-color: #FFF; box-shadow: 1px 1px 1px #fff inset; color: #3498db; border-radius: 22px; border: none;"):"æ¡ˆä»¶çµ‚äº†"===r&&(e="margin: .5rem; border: 1px solid #c0392b; background-color: #ffeeec; color: #c0392b;"),s+=`<button class="swal2-styled" id="swal-action-${t}" style="${e}">${o}</button>`}}),Swal.fire({title:"ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å¤‰æ›´ã¯ä¸è¦ã§ã™ã‹ï¼Ÿ",html:`<div style="text-align: left; padding: 0 1em; margin-bottom: 1em; text-align: center; background-color: #c7c7c745; color: #000000; padding: 1rem; line-height: 2; letter-spacing: 0.05rem; font-size: 1.3rem; border-color: #FFF; border-width: thick;">${o}</div>`+s,footer:'<div style="display: flex; justify-content: center; align-items: center; padding-top: 1rem;">\n            <button class="swal2-styled" id="swal-comment-only" style="background-color: #3598db; color: #FFF;">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã¯ä¸è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸ</button>\n            <a href="#" id="swal-cancel-link" style="color: #777; text-decoration: none; margin-left: auto; position: absolute; right: 2rem; bottom: 1.2rem; font-size: .8rem;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>\n          </div>',showCancelButton:!1,showConfirmButton:!1,width:"55%",didOpen:()=>{console.log("Swal.fire: ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºå®Œäº†"),a.forEach((e,n)=>{const o=document.getElementById(`swal-action-${n}`);o&&o.addEventListener("click",()=>{console.log(`Swal.fire: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã€Œ${e.querySelector(".gaia-app-statusbar-action-label")?.innerText}ã€ã‚¯ãƒªãƒƒã‚¯`),e.click();const n=new MutationObserver(()=>{console.log("MutationObserver: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºéƒ¨åˆ†ã®DOMå¤‰æ›´ã‚’æ¤œçŸ¥"),n.disconnect(),t=!0,r.click(),console.log("MutationObserver: ã‚³ãƒ¡ãƒ³ãƒˆé€ä¿¡ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯"),setTimeout(()=>{t=!1,console.log("setTimeout: isPopupProcessingã‚’falseã«ãƒªã‚»ãƒƒãƒˆ")},100)}),o=document.querySelector(".gaia-app-statusbar-statusmenu");o&&(n.observe(o,{childList:!0,subtree:!0}),console.log("MutationObserver: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºéƒ¨åˆ†ã®ç›£è¦–é–‹å§‹")),Swal.close()})});const e=document.getElementById("swal-comment-only");e&&e.addEventListener("click",()=>{console.log("Swal.fire: ã€Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã¯ä¸è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯"),t=!0,r.click(),setTimeout(()=>{t=!1,console.log("setTimeout: isPopupProcessingã‚’falseã«ãƒªã‚»ãƒƒãƒˆ")},100),Swal.close()});const n=document.getElementById("swal-cancel-link");n&&n.addEventListener("click",e=>{e.preventDefault(),console.log("Swal.fire: ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯"),Swal.close()})}})})))}).observe(e,{childList:!0,subtree:!0})})(),e})}()},390:(e,t,n)=>{var o={"./auto_fill_same_person.js":916,"./case_summary_sync.js":155,"./comment-reactions.js":804,"./commentPanel-launcher.js":920,"./index.js":312,"./linkify_case_number.js":781,"./process_management_popup.js":330,"./save_last_comment_datetime.js":438,"./schedule_app.js":295,"./scroll_to_error.js":898,"./task_app.js":423,"./title_autoset.js":760};function r(e){var t=a(e);return n(t)}function a(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id=390},423:()=>{const e="case_id",t="case_id",n="title",o="due_date",r="assignee",a="task_status",s="taskPanel",c="case_type",i={22:"åˆ‘äº‹äº‹ä»¶",26:"äº¤é€šäº‹æ•…",55:"åˆ‘äº‹äº¤é€šä»¥å¤–"};!function(){"use strict";const l=e=>kintone.api.url(e.endsWith(".json")?e:`${e}.json`,!0),d=(e="")=>String(e).replace(/\\/g,"\\\\").replace(/"/g,'\\"');kintone.events.on(["app.record.detail.show"],async e=>{const t=kintone.app.record.getSpaceElement(s);if(!t)return e;if(!t.dataset.initedTaskPanel){t.dataset.initedTaskPanel="1";try{await window.userTaskPanelInit(t)}catch(e){console.warn("[task] auto init failed:",e)}}return e}),window.userTaskPanelInit=async function(u,p){const m=kintone.app.record.get(),f=m&&m.record?m.record:{};kintone.app.getId(),m&&m.record&&m.recordId||kintone.app.record.getId(),await async function(u,p,m,f,h){try{if(!(u=function(e){if(e&&1===e.nodeType)return e;const t=document.querySelector('[data-mirror-of="user-js-taskPanel"]');if(t)return t;const n=kintone.app.record.getSpaceElement(s);if(n)return n;const o=document.querySelector(".ocean-ui-comments-commentform-form");if(o){const e=document.createElement("div");return e.dataset.mirrorOf="user-js-taskPanel",Object.assign(e.style,{marginTop:"12px",borderTop:"1px dashed #e5e7eb",paddingTop:"12px"}),o.insertAdjacentElement("afterend",e),e}const r=document.querySelector("#record-gaia, .contents-gaia, body"),a=document.createElement("div");return a.dataset.mirrorOf="user-js-taskPanel",r.appendChild(a),a}(u)))return console.warn("[task] mountEl not found");u.style.display="",u.innerHTML="";const g=document.createElement("div");if(g.classList.add("k-task-panel"),Object.assign(g.style,{padding:"16px",backgroundColor:"#3598DB",color:"#FFFFFF",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",marginBottom:"1rem",display:""}),g.innerHTML='\n        <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">\n          <strong>ã‚¿ã‚¹ã‚¯è¿½åŠ </strong>\n          <div style="margin-left:auto; display:flex; gap:6px;">\n            <button id="task-show-list" type="button">ã‚¿ã‚¹ã‚¯ä¸€è¦§</button>\n            <button id="task-close" type="button" aria-label="é–‰ã˜ã‚‹ï¼ˆEscï¼‰">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>\n          </div>\n        </div>\n        <style>\n          .k-task-panel input, .k-task-panel textarea, .k-task-panel select {\n            border: 1px solid #e3e7e8; border-radius: 6px; color: #000;\n          }\n          .k-task-panel input:focus, .k-task-panel textarea:focus, .k-task-panel select:focus, .k-task-panel button:focus {\n            outline: none; box-shadow: 0 0 0 3px rgba(227,231,232,.4); border-color: #e3e7e8;\n          }\n          #task-show-list, #task-close { border: 1px solid #e3e7e8; background:#fff; padding: 6px 10px; border-radius: 6px; font-size: 12px; color: #333; }\n          #task-show-list:hover, #task-close:hover { background: #f5f7f8; }\n          .task-add-row{ display:grid; grid-template-columns: 1fr 260px; gap:12px; align-items:stretch; margin-top:8px; }\n          .task-add-left textarea{ width:100%; height:100%; min-height:120px; resize:vertical; padding:10px; box-sizing:border-box; }\n          .task-add-right{ display:flex; flex-direction:column; gap:8px; }\n          .task-add-right > *{ width:100%; box-sizing:border-box; }\n          .task-add-right button{ height:36px; background:#5DADE2; color:#fff; border-radius: 6px;font-size: .9rem; border: none;}\n          .task-add-right button:hover{ background:#85C1E9;}\n          @media (max-width: 640px){ .task-add-row{ grid-template-columns: 1fr; } }\n          .k-task-panel .task-add-right .task-owner, .k-task-panel .task-add-right .task-due{ padding:8px 4px; min-height:36px; box-sizing:border-box; }\n        </style>\n\n        <div id="task-list" style="display:none; flex-direction:column; gap:6px; margin-bottom:12px;"></div>\n        <div class="task-add-row">\n          <div class="task-add-left">\n            <textarea id="task-title" placeholder="ä»¶åã‚’å…¥åŠ›" rows="4"></textarea>\n          </div>\n          <div class="task-add-right">\n            <select id="task-owner" class="task-owner">\n              <option value="" disabled selected>æ‹…å½“è€…ã‚’é¸æŠ</option>\n            </select>\n            <input id="task-due" type="date" class="task-due">\n            <button id="task-add" type="button">ï¼‹ ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ </button>\n          </div>\n        </div>\n        ',u.appendChild(g),h&&h.comment){const N=g.querySelector("#task-title");if(N){const M=N.value,A=M?`${M}\n${h.comment}`:h.comment;N.value=A}}const v=g.querySelector("#task-list"),y=g.querySelector("#task-owner"),k=g.querySelector("#task-due"),b=new Date,w=b.getFullYear(),x=String(b.getMonth()+1).padStart(2,"0"),E=String(b.getDate()).padStart(2,"0");k.value=`${w}-${x}-${E}`;const S=function(){try{const e=kintone.app.getId();if(e)return Number(e)}catch(e){}const e=location.pathname.match(/\/k\/(\d+)\//);return e?Number(e[1]):NaN}(),$=i[S]||"",T=(p?.[e]?.value||"").trim();async function _(){if(!T)return[];const e=d(T),n=$?` and ${c} = "${d($)}"`:"",r=`${t} = "${e}"${n} order by ${o} asc`;try{const e=await kintone.api(l("/k/v1/records.json"),"GET",{app:23,query:r});if(0===(e.records||[]).length&&/^[0-9]+$/.test(T)){const e=`${t} = ${T}${n} order by ${o} asc`;return(await kintone.api(l("/k/v1/records.json"),"GET",{app:23,query:e})).records||[]}return e.records||[]}catch(e){return console.error("[task] ã‚¿ã‚¹ã‚¯å–å¾—ã‚¨ãƒ©ãƒ¼",e),v.innerHTML=`<div style="color:#c00;">ã‚¿ã‚¹ã‚¯å–å¾—ã§ã‚¨ãƒ©ãƒ¼ï¼š${e?.message||JSON.stringify(e)}</div>`,[]}}function L(e){const t=e.$id.value,s=e[n]?.value||"(ç„¡é¡Œ)",c=e[o]?.value||"",i=e[a]?.value||"",d=Array.isArray(e[r]?.value)?e[r].value.map(e=>e.name||e.code).join(", "):"",u=document.createElement("div");return Object.assign(u.style,{display:"grid",gridTemplateColumns:"1fr auto auto auto",gap:"8px",alignItems:"center",padding:"6px 8px",background:"transparent",borderBottom:"dotted 1px #8fbed0"}),u.innerHTML=`\n          <div>\n            <div style="font-weight:600">${s}</div>\n            <div style="font-size:12px;color:#666">çŠ¶æ…‹: ${i||"â€”"} / æ‹…å½“: ${d||"â€”"} / æœŸé™: ${c||"â€”"}</div>\n          </div>\n          <button data-act="start" type="button" title="é€²è¡Œä¸­ã«ã™ã‚‹">é€²è¡Œä¸­</button>\n          <button data-act="done" type="button" title="å®Œäº†ã«ã™ã‚‹">å®Œäº†</button>\n          <a href="${location.origin}/k/23/show#record=${t}" target="_blank">é–‹ã</a>`,u.addEventListener("click",async e=>{const n=e.target.closest("button");if(!n)return;const o="start"===n.dataset.act?"é€²è¡Œä¸­":"å®Œäº†";try{await kintone.api(l("/k/v1/record"),"PUT",{app:23,id:t,record:{[a]:{value:o}}}),q()}catch(e){console.error("[task] æ›´æ–°ã‚¨ãƒ©ãƒ¼",e),alert("ã‚¿ã‚¹ã‚¯æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚")}}),u}async function q(){v.textContent="èª­è¾¼ä¸­â€¦";const e=await _();if(v.innerHTML="",e.length)for(const t of e)v.appendChild(L(t));else v.textContent="å¯¾è±¡ã‚¿ã‚¹ã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚"}T||(v.innerHTML=`<div style="color:#c00;">æ¡ˆä»¶å´ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€Œ${e}ã€ãŒç©ºã§ã™ã€‚å€¤ã‚’å…¥ã‚Œã‚‹ã¨ã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤ºãƒ»è¿½åŠ ã§ãã¾ã™ã€‚</div>`),await async function(){const e=kintone.getLoginUser();y.innerHTML="";const t=document.createElement("option");t.value=e.code,t.textContent=`${e.name}ï¼ˆè‡ªåˆ†ï¼‰`,y.appendChild(t);try{let t=0,n=100;for(;;){const o=(await kintone.api(l("/v1/users"),"GET",{offset:t,size:n})).users||[];for(const t of o){if(!t.valid||t.code===e.code)continue;const n=document.createElement("option");n.value=t.code,n.textContent=t.name,y.appendChild(n)}if(o.length<n)break;t+=n}y.value=e.code}catch(e){console.warn("[task] ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—å¤±æ•—:",e)}}();const C=g.querySelector("#task-add");C.addEventListener("click",async()=>{const s=(g.querySelector("#task-title").value||"").trim(),i=(g.querySelector("#task-due").value||"").trim(),u=g.querySelector("#task-owner").value||kintone.getLoginUser().code;if(!s)return alert("ä»¶åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");if(!i)return alert("æœŸé™ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");if(!T)return alert(`æ¡ˆä»¶å´ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€Œ${e}ã€ãŒç©ºã§ã™ã€‚å€¤ã‚’å…¥ã‚Œã¦ã‹ã‚‰è¿½åŠ ã—ã¦ãã ã•ã„ã€‚`);const p=`${t} = "${d(T)}" and ${n} = "${d(s)}" limit 1`;try{if(((await kintone.api(l("/k/v1/records"),"GET",{app:23,query:p})).records||[]).length)return alert("ã“ã®æ¡ˆä»¶ã«åŒåã®ã‚¿ã‚¹ã‚¯ãŒæ—¢ã«ã‚ã‚Šã¾ã™ã€‚ä»¶åã‚’å¤‰ãˆã¦ãã ã•ã„ã€‚")}catch(e){console.warn("[task] é‡è¤‡ç¢ºèªã«å¤±æ•—ï¼ˆç¶šè¡Œï¼‰:",e)}const m={[t]:{value:T},[n]:{value:s},[o]:{value:i||""},[r]:{value:[{code:u}]},[a]:{value:"æœªç€æ‰‹"},[c]:{value:$||""}};C.disabled=!0;const f=C.textContent;C.textContent="ä½œæˆä¸­â€¦";try{const e=await kintone.api(l("/k/v1/record"),"POST",{app:23,record:m});alert(`ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã—ãŸï¼ˆ#${e.id}ï¼‰ã€‚`),g.querySelector("#task-title").value="",g.querySelector("#task-due").value="";const t=kintone.getLoginUser();t?.code&&(y.value=t.code),await q()}catch(e){console.error("[task] ä½œæˆã‚¨ãƒ©ãƒ¼",e);const t=e?.message||e?.errors&&JSON.stringify(e.errors)||e?.code||"ä¸æ˜ãªã‚¨ãƒ©ãƒ¼";alert(`ã‚¿ã‚¹ã‚¯ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n${t}`)}finally{C.disabled=!1,C.textContent=f}});const j=g.querySelector("#task-show-list");let O=!1;j.addEventListener("click",()=>{"none"===v.style.display?(v.style.display="flex",j.textContent="ä¸€è¦§ã‚’éš ã™",O||(q(),O=!0)):(v.style.display="none",j.textContent="ã‚¿ã‚¹ã‚¯ä¸€è¦§")});const I=()=>{g.style.display="none",u.dispatchEvent(new CustomEvent("taskPanel:hidden",{bubbles:!1}))};g.querySelector("#task-close").addEventListener("click",I);const P=e=>{"Escape"===e.key&&"none"!==g.style.display&&I()};document.addEventListener("keydown",P),u.addEventListener("taskPanel:hidden",()=>{document.removeEventListener("keydown",P)})}catch(z){console.error("[task] initTaskPanel fatal:",z)}}(u,f,0,0,p)}}()},438:()=>{!function(){"use strict";const e="last_comment_datetime";function t(n=0){const o=kintone.app.record.getId();if(!o)return;const r=document.querySelector("#sidebar-list-gaia");if(!r)return void(n<10?setTimeout(()=>t(n+1),300):console.warn(`[${e}] Comment area not found after retries.`));if("true"===r.dataset.lastCommentObserverAttached)return;r.dataset.lastCommentObserverAttached="true";const a=new MutationObserver(t=>{let n=!1;for(const e of t){if("childList"===e.type&&e.addedNodes.length>0)for(const t of e.addedNodes)if(1===t.nodeType&&t.classList.contains("itemlist-item-gaia")){n=!0;break}if(n)break}n&&(console.log(`[${e}] New comment detected. Fetching latest comment from API...`),async function(t){try{const n=await kintone.api(kintone.api.url("/k/v1/record/comments",!0),"GET",{app:kintone.app.getId(),record:t,order:"desc",limit:1});if(!n.comments||0===n.comments.length)return void console.warn(`[${e}] No comments found for Record ID: ${t}.`);const o=n.comments[0].createdAt;await kintone.api(kintone.api.url("/k/v1/record",!0),"PUT",{app:kintone.app.getId(),id:t,record:{[e]:{value:o}}}),console.log(`[${e}] Updated to: ${o} (Record ID: ${t})`)}catch(n){console.error(`[${e}] Failed to update last comment datetime for Record ID: ${t}`,n)}}(o))});a.observe(r,{childList:!0,subtree:!0}),console.log(`[${e}] Watching for new comments to update last comment datetime for Record ID: ${o}.`)}kintone.events.on("app.record.detail.show",t),window.addEventListener("urlchanged",()=>{const e=document.querySelector("#sidebar-list-gaia");e&&delete e.dataset.lastCommentObserverAttached,setTimeout(t,500)})}()},760:()=>{!function(){"use strict";const e="staff",t="staff_text",n="case_title",o="title_display";function r(r){const a=r.record||{};if(!a[t]||!a[o])return r;const s=a[t]?(c=a[e]?.value,Array.isArray(c)&&c.length?c.map(e=>e&&e.name).filter(Boolean).join("ãƒ»"):""):"";var c;a[t].value=s;const i=a[n]&&a[n].value||"";return a[o].value=function(e,t){const n=(e||"").trim(),o=(t||"").trim();return o?`${n}ï¼ˆæ‹…å½“ï¼š${o}ï¼‰`:n}(i,s),r}kintone.events.on(["app.record.create.show","app.record.edit.show",`app.record.create.change.${e}`,`app.record.edit.change.${e}`,`app.record.create.change.${n}`,`app.record.edit.change.${n}`],r),kintone.events.on(["app.record.create.submit","app.record.edit.submit"],r)}()},781:()=>{!function(){"use strict";kintone.events.on("app.record.index.show",function(e){const t=e.records;if(!t||0===t.length)return e;const n=kintone.app.getFieldElements("case_number");return n&&0!==n.length?(t.forEach((e,t)=>{const o=e.case_number?.value,r=e.sflink?.value;if(!o||!r)return;const a=n[t];if(!a)return;const s=a.querySelector("div");if(!s)return;s.innerHTML="";const c=document.createElement("a");c.href=r,c.textContent=o,c.target="_blank",c.style.color="#3598db",c.style.zIndex="2",c.style.position="relative",s.appendChild(c)}),e):e})}()},804:()=>{!function(){"use strict";const e=["ğŸ˜„","ğŸ˜¢","â¤ï¸","ğŸ‘Œ"],t="reaction_log",n={":smile:":"ğŸ˜„",":cry:":"ğŸ˜¢",":heart:":"â¤ï¸",":ok:":"ğŸ‘Œ"},o={};async function r(e){return(await kintone.api(kintone.api.url("/k/v1/record",!0),"GET",{app:kintone.app.getId(),id:e})).record}async function a(e,n,o){await kintone.api(kintone.api.url("/k/v1/record",!0),"PUT",{app:kintone.app.getId(),id:e,record:{[t]:{value:JSON.stringify(n)}},revision:o})}async function s(){Object.keys(o).length||(await kintone.api(kintone.api.url("/v1/users.json",!0),"GET",{})).users.forEach(e=>{const t=`https://${location.hostname}/api/user/photo.do/-/user.png?id=${e.id}&size=NORMAL`;o[e.email]={name:e.name,photoUrl:e.photo&&e.photo.url?e.photo.url:t}})}async function c(e){return Object.keys(o).length||await s(),o[e]?.photoUrl||"https://static.cybozu.com/kintone/v2.0/images/people/no_photo.png"}function i(e){let t=e.innerHTML;for(const[e,o]of Object.entries(n))t=t.replaceAll(e,o);e.innerHTML=t}async function l(t,n,r,a){const s=document.createElement("div");s.className="cw-reaction-wrapper";const i=document.createElement("div");i.className="cw-reaction-users";const l=new Set;for(const e of Object.keys(r[n]||{}))(r[n][e]||[]).forEach(e=>l.add(e));for(const e of l){const t=await c(e),a=document.createElement("div");a.className="cw-user-icon";const s=document.createElement("img");s.src=t,a.appendChild(s);const l=document.createElement("span");l.className="cw-emoji-badge";for(const[t,o]of Object.entries(r[n]||{}))o.includes(e)&&(l.textContent=t);l.textContent&&a.appendChild(l);const d=document.createElement("div");d.className="cw-tooltip",d.textContent=`${o[e]?.name||e}`,a.appendChild(d),i.appendChild(a)}const d=document.createElement("div");d.className="cw-reactions",e.forEach(e=>{const t=r[n]?.[e]||[],o=t.length?`<span>${t.length}</span>`:"",s=t.includes(a)?"active":"",c=document.createElement("button");c.className=`cw-react-btn ${s}`,c.dataset.emoji=e,c.dataset.commentId=n,c.innerHTML=`${e}${o}`,d.appendChild(c)}),s.appendChild(i),s.appendChild(d);const u=t.querySelector(".text11.itemlist-footer-gaia");u&&!u.querySelector(".cw-reaction-wrapper")&&u.appendChild(s)}kintone.events.on("app.record.detail.show",async function(e){const n=e.recordId,o=kintone.getLoginUser().email,c=await r(n),d=JSON.parse(c[t].value||"{}");async function u(e){const t=document.querySelectorAll(".itemlist-item-gaia");for(const n of t){const t=n.querySelector(".itemlist-datetime-gaia a"),r=t?.href.match(/comment=(\d+)/)?.[1];if(!r)continue;const a=n.querySelector(".commentlist-body-gaia > div");a&&i(a),await l(n,r,e,o)}}await s(),await u(d);const p=document.querySelector("#sidebar-list-gaia");if(p){const e=new MutationObserver(async o=>{e.disconnect();let a=!1;for(const e of o){for(const t of e.addedNodes)if(1===t.nodeType&&t.classList.contains("itemlist-item-gaia")){a=!0;break}if(a)break}if(a){console.log("ğŸ†• ã‚³ãƒ¡ãƒ³ãƒˆã‚¨ãƒªã‚¢å¤‰åŒ–æ¤œçŸ¥ â†’ å†æç”»");const e=await r(n),o=JSON.parse(e[t].value||"{}");await u(o)}e.observe(p,{childList:!0,subtree:!0})});e.observe(p,{childList:!0,subtree:!0}),console.log("ğŸ‘€ ã‚³ãƒ¡ãƒ³ãƒˆé ˜åŸŸç›£è¦–é–‹å§‹")}document.body.dataset.reactionHandlerAttached||(document.body.dataset.reactionHandlerAttached="true",document.body.addEventListener("click",async e=>{if(!e.target.classList.contains("cw-react-btn"))return;const n=kintone.app.record.getId(),o=kintone.getLoginUser().email,s=e.target.dataset.emoji,c=e.target.dataset.commentId;for(let i=0;i<5;i++)try{const i=await r(n),d=JSON.parse(i[t].value||"{}"),u=i.$revision.value,p=JSON.parse(JSON.stringify(d));p[c]=p[c]||{};const m=Object.entries(p[c]).find(([,e])=>Array.isArray(e)&&e.includes(o)),f=m?m[0]:null;if(f===s)p[c][s]=(p[c][s]||[]).filter(e=>e!==o),0===p[c][s].length&&delete p[c][s];else{f&&(p[c][f]=(p[c][f]||[]).filter(e=>e!==o),p[c][f].length||delete p[c][f]);const e=p[c][s]||[];e.includes(o)||e.push(o),p[c][s]=e}await a(n,p,u);const h=e.target.closest(".itemlist-item-gaia");if(h){const e=h.querySelector(".cw-reaction-wrapper");e&&e.remove(),await l(h,c,p,o)}return}catch(e){if(!("CB_VA01"===e.code&&i<4))return console.error("Failed to save reaction:",e),void alert("ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ç”»é¢ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");console.warn(`Reaction conflict detected. Retrying... (${i+1}/5)`),await new Promise(e=>setTimeout(e,100+200*Math.random()))}}))})}()},898:()=>{!function(){"use strict";console.log("[scroll_to_error] ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸã€‚"),kintone.events.on(["app.record.create.show","app.record.edit.show"],function(e){return location.pathname.includes("/edit")?(new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.length>0&&e.addedNodes.forEach(function(e){if(1===e.nodeType&&(e.matches(".notifier-header-cybozu")?e:e.querySelector(".notifier-header-cybozu"))){const e=document.querySelector(".input-error-cybozu");if(e){const t=e.closest(".control-value-gaia")||e.closest(".control-gaia");t?t.scrollIntoView({behavior:"smooth",block:"center"}):console.warn("[scroll_to_error] ã‚¨ãƒ©ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¦ªè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚",e)}else console.warn("[scroll_to_error] ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã¯è¡¨ç¤ºã•ã‚ŒãŸãŒã€.input-error-cybozu ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")}})})}).observe(document.body,{childList:!0,subtree:!0}),e):e})}()},916:()=>{!function(){"use strict";kintone.events.on(["app.record.create.change.same_person","app.record.edit.change.same_person"],function(e){const t=e.record;return t.same_person.value.includes("ã¯ã„")?(t.contractor_name.value=t.suspect_name.value,t.contractor_name_kana.value=t.suspect_name_kana.value):t.contractor_name.value===t.suspect_name.value&&t.contractor_name_kana.value===t.suspect_name_kana.value&&(t.contractor_name.value="",t.contractor_name_kana.value=""),e}),kintone.events.on(["app.record.create.change.suspect_name","app.record.create.change.suspect_name_kana","app.record.edit.change.suspect_name","app.record.edit.change.suspect_name_kana"],function(e){const t=e.record;return t.same_person.value.includes("ã¯ã„")&&(t.contractor_name.value=t.suspect_name.value,t.contractor_name_kana.value=t.suspect_name_kana.value),e})}()},920:()=>{!function(){"use strict";const e=kintone.app.record.getSpaceElement;kintone.app.record.getSpaceElement=function(t){return e.call(this,t)||document.getElementById(t)||null};const t=()=>{(function(){const e=document.querySelector(".ocean-ui-comments-commentform-form");if(!e)return!1;const t="comment-task-launcher";if(document.getElementById(t))return!0;const n=function(e,t){const n=document.createElement("button");return n.id=t,n.type="button",n.className="ocean-ui-comments-commentform-cancel",n.style.marginLeft="2rem",n.style.marginTop="1rem",n.style.float="right",n.innerHTML='\n      <svg viewBox="0 -960 960 960" style="width: 1em; height: 1em; fill: currentColor; margin-right: 0.4em; vertical-align: middle;">\n        <path d="m424-318 282-282-56-56-226 226-114-114-56 56 170 170ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h168q13-36 43.5-58t68.5-22q38 0 68.5 22t43.5 58h168q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm280-590q13 0 21.5-8.5T510-820q0-13-8.5-21.5T480-850q-13 0-21.5 8.5T450-820q0 13 8.5 21.5T480-790ZM200-200v-560 560Z"></path>\n      </svg>\n      <span>ã‚¿ã‚¹ã‚¯è¿½åŠ </span>\n    ',n.style.alignItems="center",n}(0,t);e.appendChild(n),n.addEventListener("click",t=>{t.preventDefault();let n="";const o=e.querySelector(".ocean-ui-editor-field.editable");if(o)n=o.innerText;else{const t=e.querySelector(".ocean-ui-comments-commentform-textarea");t&&(n=t.value)}!function(e,t,n,o,r){const a=document.querySelector(`[data-mirror-of="${t}"]`),s={mountEl:null,comment:r};if(a){const e=a.querySelector(".k-schedule-panel, .k-task-panel");return e&&"none"===e.style.display?e.style.display="":e||(s.mountEl=a,"function"==typeof window[n]?window[n](s.mountEl,{comment:s.comment}):document.dispatchEvent(new CustomEvent(o,{detail:s}))),void a.scrollIntoView({behavior:"smooth",block:"center"})}const c=document.createElement("div");c.dataset.mirrorOf=t,c.style.marginTop="12px",c.style.borderTop="1px dashed #e5e7eb",c.style.paddingTop="12px",e.insertAdjacentElement("afterend",c),s.mountEl=c,"function"==typeof window[n]?window[n](s.mountEl,{comment:s.comment}):document.dispatchEvent(new CustomEvent(o,{detail:s})),c.scrollIntoView({behavior:"smooth",block:"center"})}(e,"user-js-taskPanel","userTaskPanelInit","user-js-open-task",n)});const o=document.querySelector(".ocean-ui-comments-commentarea");return!o||(new MutationObserver(e=>{for(const t of e)"attributes"===t.type&&"class"===t.attributeName&&(t.target.classList.contains("ocean-ui-comments-commentform-open")?n.style.visibility="visible":n.style.visibility="hidden")}).observe(o,{attributes:!0,attributeFilter:["class"],subtree:!1}),o.classList.contains("ocean-ui-comments-commentform-open")&&(n.style.visibility="visible"),!0)})()||setTimeout(t,150)};kintone.events.on("app.record.detail.show",()=>{t()}),function(e){const t=e.pushState,n=e.replaceState;let o=location.href;const r=e=>{e&&e.toString()!==o&&(o=e.toString(),window.dispatchEvent(new CustomEvent("urlchanged",{detail:{url:o}})))};e.pushState=function(n,o,a){const s=t.apply(e,[n,o,a]);return r(a),s},e.replaceState=function(t,o,a){const s=n.apply(e,[t,o,a]);return r(a),s},window.addEventListener("popstate",()=>{r(location.href)})}(window.history),window.addEventListener("urlchanged",e=>{setTimeout(()=>{const e=document.getElementById("comment-task-launcher");e&&e.remove();const n=document.querySelector('[data-mirror-of="user-js-taskPanel"]');n&&n.remove(),t()},200)})}()}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(312)})();