(()=>{var e={3:()=>{!function(){"use strict";const e=[23],o="case_type",n="task_status",t={åˆ‘äº‹äº‹ä»¶:"#FFDCDC",äº¤é€šäº‹æ•…:"#DCEEFF",åˆ‘äº‹äº¤é€šä»¥å¤–:"#fff4ce","":"#F0F0F0",ãã®ä»–:"#F0F0F0"},r=e=>kintone.api.url(e.endsWith(".json")?e:`${e}.json`,!0);kintone.events.on(["app.record.index.show"],async s=>{if(!document.querySelector(".calendar-gaia"))return s;console.log("Calendar view detected. Applying color coding...");const c=document.querySelectorAll(".calendar-record-gaia");if(0===c.length)return console.log("No calendar items found."),s;const a=new Map;if(c.forEach(o=>{const n=o.querySelector("a");if(n){const o=n.href.match(/\/k\/(\d+)\/show#record=(\d+)/);if(o&&o[1]&&o[2]){const n=parseInt(o[1],10),t=o[2];e.includes(n)&&(a.has(n)||a.set(n,new Set),a.get(n).add(t))}}}),0===a.size)return console.log("No relevant app record IDs found from calendar items."),s;const i=new Map;for(const[e,t]of a.entries()){const s=Array.from(t);if(0!==s.length){console.log(`Fetching details for ${s.length} records from App ID: ${e}`);try{const t=`$id in (${s.join(",")})`;((await kintone.api(r("/k/v1/records"),"GET",{app:e,query:t,fields:["$id",o,n]})).records||[]).forEach(t=>{const r=`${e}_${t.$id.value}`;i.set(r,{caseType:t[o]?.value||"",taskStatus:t[n]?.value})})}catch(o){console.error(`ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ å–å¾—ã‚¨ãƒ©ãƒ¼ (App ID: ${e}):`,o)}}}return c.forEach(e=>{const o=e.querySelector("a");if(o){const n=o.href.match(/\/k\/(\d+)\/show#record=(\d+)/);if(n&&n[1]&&n[2]){const o=`${parseInt(n[1],10)}_${n[2]}`,r=i.get(o);if(!r)return;const{caseType:s,taskStatus:c}=r,a=t[s]||t["ãã®ä»–"];a&&(e.style.backgroundColor=a,e.style.padding="2px 6px",e.style.margin="2px",e.style.borderRadius="3px",e.style.listStyle="none"),"å®Œäº†"===c&&e.classList.add("task-completed")}}}),console.log("Color coding applied successfully for multiple apps."),s})}()},73:(e,o,n)=>{var t={"./calendar_customization.js":3,"./dynamic_related_records.js":139,"./index.js":983,"./task_app_triggers.js":368};function r(e){var o=s(e);return n(o)}function s(e){if(!n.o(t,e)){var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return t[e]}r.keys=function(){return Object.keys(t)},r.resolve=s,e.exports=r,r.id=73},139:()=>{!function(){"use strict";const e="case_type",o="related_records_space",n="case_id",t={åˆ‘äº‹äº‹ä»¶:22,äº¤é€šäº‹æ•…:26,åˆ‘äº‹äº¤é€šä»¥å¤–:55},r="title_display";kintone.events.on(["app.record.detail.show"],async s=>{const c=s.record,a=kintone.app.record.getId(),i=c[e]?.value,l=c[n]?.value,d=kintone.app.record.getSpaceElement(o);if(!d)return console.warn(`ã‚¹ãƒšãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ '${o}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚`),s;d.innerHTML="",d.style.padding="10px",d.style.border="1px solid #e3e7e8",d.style.borderRadius="6px",d.style.backgroundColor="#f7f9fa",d.style.marginTop="1rem";const p=document.createElement("h4");p.style.margin="0 0 10px 0",p.style.borderBottom="1px solid #e3e7e8",p.style.paddingBottom="5px",p.textContent="ğŸ“„ é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰",d.appendChild(p);const u=document.createElement("div");if(d.appendChild(u),!i)return u.innerHTML='<p style="color:#c00;">åˆ†é‡ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã§ãã¾ã›ã‚“ã€‚</p>',s;if(!l)return u.innerHTML='<p style="color:#c00;">ç¾åœ¨ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®case_idãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã§ãã¾ã›ã‚“ã€‚</p>',s;const f=t[i];if(!f)return u.innerHTML=`<p>åˆ†é‡ '${i}' ã«å¯¾å¿œã™ã‚‹ã‚¢ãƒ—ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚</p>`,s;try{u.innerHTML="<p>é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>";const e=`$id = "${l}"`;console.log("ç¾åœ¨ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ID:",a),console.log("ç¾åœ¨ã®åˆ†é‡:",i),console.log("ç¾åœ¨ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®case_id:",l),console.log("å¯¾è±¡ã‚¢ãƒ—ãƒªID:",f),console.log("æ¤œç´¢ã‚¯ã‚¨ãƒª:",e);const o=(await kintone.api((g="/k/v1/records",kintone.api.url(g.endsWith(".json")?g:`${g}.json`,!0)),"GET",{app:f,query:e,fields:["$id",r]})).records||[];if(0===o.length)u.innerHTML="<p>é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>";else{const e=document.createElement("ul");e.style.listStyle="none",e.style.padding="0",e.style.margin="0",o.forEach(o=>{const n=document.createElement("li");n.style.padding="5px";const t=o.$id.value,s=o[r]?.value||"(ã‚¿ã‚¤ãƒˆãƒ«ãªã—)",c=document.createElement("a");c.href=`${location.origin}/k/${f}/show#record=${t}`,c.target="_blank",c.textContent=s,c.style.textDecoration="none",c.style.color="#3598db",n.appendChild(c),e.appendChild(n)}),u.innerHTML="",u.appendChild(e)}}catch(e){console.error("é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—ã‚¨ãƒ©ãƒ¼:",e),u.innerHTML=`<p style="color:#c00;">é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${e.message||JSON.stringify(e)}</p>`}var g;return s}),kintone.events.on("app.record.detail.show",function(o){if(23!==o.appId)return o;console.log("Task record detail view detected. Preparing to show iframe...");const r=o.record,s=r[e]?.value,c=r[n]?.value,a=t[s];let i="";if(a&&c?i=`${location.origin}/k/${a}/show#record=${c}`:console.log("Required fields for iframe URL are missing (case_type or case_id)."),!i)return console.log("iframe URL is not defined. Skipping iframe creation."),o;const l="custom-iframe-container";let d=document.getElementById(l);if(d)d.innerHTML="";else{d=document.createElement("div"),d.id=l;const e=document.getElementById("record-gaia");if(!e)return console.warn("#record-gaia element not found. Cannot insert iframe container."),o;e.insertAdjacentElement("afterend",d)}const p=document.createElement("iframe");return p.src=i,p.width="100%",p.height="800px",p.style.border="none",d.appendChild(p),console.log(`iframe displayed with URL: ${i}`),o})}()},368:()=>{!function(){"use strict";const e="ã‚¿ã‚¹ã‚¯ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",o={åˆ‘äº‹äº‹ä»¶:22,äº¤é€šäº‹æ•…:26,åˆ‘äº‹äº¤é€šä»¥å¤–:55};async function n(e,n){const t=e.case_type?.value,r=e.case_id?.value,s=o[t];var c;if(s&&r)try{await kintone.api((c="/k/v1/record/comment",kintone.api.url(c.endsWith(".json")?c:`${c}.json`,!0)),"POST",{app:s,record:r,comment:{text:n}}),console.log(`[task-trigger] é–¢é€£å…ƒãƒ¬ã‚³ãƒ¼ãƒ‰ (app: ${s}, record: ${r}) ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã—ã¾ã—ãŸã€‚`)}catch(e){console.error("[task-trigger] é–¢é€£å…ƒãƒ¬ã‚³ãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",e)}else console.warn("[task-trigger] é–¢é€£å…ƒã®ã‚¢ãƒ—ãƒªIDã¾ãŸã¯ãƒ¬ã‚³ãƒ¼ãƒ‰IDãŒè¦‹ã¤ã‹ã‚‰ãªã„ãŸã‚ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚",{caseType:t,sourceRecordId:r})}function t(){const e=document.getElementById("custom-iframe-container");if(e){const o=e.querySelector("iframe");o&&(console.log("[task-trigger] Reloading related record iframe after 500ms."),setTimeout(()=>{o.src=o.src},500))}}kintone.events.on("app.record.create.submit.success",async e=>{const o=e.record,r=o["ä»¶å"]?.value,s=`ã‚¿ã‚¹ã‚¯ãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚\n\nä»¶å: ${r}\n\nâ–¼ã‚¿ã‚¹ã‚¯è©³ç´°\n${location.origin}/k/23/show#record=${e.recordId}`;return await n(o,s),t(),e}),kintone.events.on("app.record.edit.submit.success",async o=>{const r=o.record,s=o.previous,c=s[e]?.value,a=r[e]?.value;if(c!==a){const e=r["ä»¶å"]?.value,s=`ã‚¿ã‚¹ã‚¯ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€Œ${c||"ï¼ˆç©ºï¼‰"}ã€ã‹ã‚‰ã€Œ${a}ã€ã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚\n\nä»¶å: ${e}\n\nâ–¼ã‚¿ã‚¹ã‚¯è©³ç´°\n${location.origin}/k/23/show#record=${o.recordId}`;await n(r,s),t()}return o})}()},983:(e,o,n)=>{var t;(t=n(73)).keys().forEach(t)}},o={};function n(t){var r=o[t];if(void 0!==r)return r.exports;var s=o[t]={exports:{}};return e[t](s,s.exports,n),s.exports}n.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),n(983)})();