(()=>{var e={138:(e,t,n)=>{"use strict";n.d(t,{APP_ID_TO_CASE_TYPE:()=>s,TASK_APP_ID:()=>o,TASK_CASE_TYPE:()=>r});const o=23,r={CRIMINAL:"åˆ‘äº‹äº‹ä»¶",TRAFFIC:"äº¤é€šäº‹æ•…",OTHER:"åˆ‘äº‹äº¤é€šä»¥å¤–"},s={22:r.CRIMINAL,26:r.TRAFFIC,55:r.OTHER}},342:(e,t,n)=>{var o={"./calendar_customization.js":448,"./dynamic_related_records.js":936,"./index.js":904};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=s,e.exports=r,r.id=342},448:(e,t,n)=>{"use strict";const o=e=>kintone.api.url(e.endsWith(".json")?e:`${e}.json`,!0);var r=n(138);const s=[r.TASK_APP_ID],c="case_type",i="task_status",a="case_id",d={[r.TASK_CASE_TYPE.CRIMINAL]:"#FFDCDC",[r.TASK_CASE_TYPE.TRAFFIC]:"#DCEEFF",[r.TASK_CASE_TYPE.OTHER]:"#fff4ce","":"#F0F0F0",ãã®ä»–:"#F0F0F0"},l=Object.fromEntries(Object.entries(r.APP_ID_TO_CASE_TYPE).map(([e,t])=>[t,Number(e)]));kintone.events.on(["app.record.index.show"],async e=>{if(!document.querySelector(".calendar-gaia"))return e;console.log("Calendar view detected. Applying color coding and link modification...");const t=document.querySelectorAll(".calendar-record-gaia");if(0===t.length)return e;const n=new Map;if(t.forEach(e=>{const t=e.querySelector("a");if(t){const e=t.href.match(/\/k\/(\d+)\/show#record=(\d+)/);if(e&&e[1]&&e[2]){const t=parseInt(e[1],10),o=e[2];s.includes(t)&&(n.has(t)||n.set(t,new Set),n.get(t).add(o))}}}),0===n.size)return e;const r=new Map;for(const[e,t]of n.entries()){const n=Array.from(t);if(0!==n.length)try{const t=`$id in (${n.join(",")})`;((await kintone.api(o("/k/v1/records.json"),"GET",{app:e,query:t,fields:["$id",c,i,a]})).records||[]).forEach(t=>{const n=`${e}_${t.$id.value}`;r.set(n,{caseType:t[c]?.value||"",taskStatus:t[i]?.value,caseId:t[a]?.value})})}catch(t){console.error(`ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ å–å¾—ã‚¨ãƒ©ãƒ¼ (App ID: ${e}):`,t)}}return t.forEach(e=>{const t=e.querySelector("a");if(t){const n=t.href.match(/\/k\/(\d+)\/show#record=(\d+)/);if(n&&n[1]&&n[2]){const o=parseInt(n[1],10),s=n[2],c=`${o}_${s}`,i=r.get(c);if(!i)return;const{caseType:a,taskStatus:p,caseId:u}=i,f=d[a]||d["ãã®ä»–"];f&&(e.style.backgroundColor=f,e.style.padding="2px 6px",e.style.margin="2px",e.style.borderRadius="3px",e.style.listStyle="none"),"å®Œäº†"===p&&e.classList.add("task-completed");const y=l[a];y&&u&&(t.href=`/k/${y}/show#record=${u}`,console.log(`Link rewritten for task ${s} to case ${u} in app ${y}`))}}}),console.log("Color coding and link modification applied successfully."),e})},904:(e,t,n)=>{var o;(o=n(342)).keys().forEach(o)},936:(e,t,n)=>{"use strict";n.r(t);var o=n(138);const r="case_type",s="related_records_space",c="case_id",i=Object.fromEntries(Object.entries(o.APP_ID_TO_CASE_TYPE).map(([e,t])=>[t,Number(e)])),a="title_display";kintone.events.on(["app.record.detail.show"],async e=>{const t=e.record,n=kintone.app.record.getId(),o=t[r]?.value,d=t[c]?.value,l=kintone.app.record.getSpaceElement(s);if(!l)return console.warn(`ã‚¹ãƒšãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ '${s}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚`),e;l.innerHTML="",l.style.padding="10px",l.style.border="1px solid #e3e7e8",l.style.borderRadius="6px",l.style.backgroundColor="#f7f9fa",l.style.marginTop="1rem";const p=document.createElement("h4");p.style.margin="0 0 10px 0",p.style.borderBottom="1px solid #e3e7e8",p.style.paddingBottom="5px",p.textContent="ğŸ“„ é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰",l.appendChild(p);const u=document.createElement("div");if(l.appendChild(u),!o)return u.innerHTML='<p style="color:#c00;">åˆ†é‡ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã§ãã¾ã›ã‚“ã€‚</p>',e;if(!d)return u.innerHTML='<p style="color:#c00;">ç¾åœ¨ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®case_idãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã§ãã¾ã›ã‚“ã€‚</p>',e;const f=i[o];if(!f)return u.innerHTML=`<p>åˆ†é‡ '${o}' ã«å¯¾å¿œã™ã‚‹ã‚¢ãƒ—ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚</p>`,e;try{u.innerHTML="<p>é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>";const e=`$id = "${d}"`;console.log("ç¾åœ¨ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ID:",n),console.log("ç¾åœ¨ã®åˆ†é‡:",o),console.log("ç¾åœ¨ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®case_id:",d),console.log("å¯¾è±¡ã‚¢ãƒ—ãƒªID:",f),console.log("æ¤œç´¢ã‚¯ã‚¨ãƒª:",e);const t=(await kintone.api((y="/k/v1/records",kintone.api.url(y.endsWith(".json")?y:`${y}.json`,!0)),"GET",{app:f,query:e,fields:["$id",a]})).records||[];if(0===t.length)u.innerHTML="<p>é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>";else{const e=document.createElement("ul");e.style.listStyle="none",e.style.padding="0",e.style.margin="0",t.forEach(t=>{const n=document.createElement("li");n.style.padding="5px";const o=t.$id.value,r=t[a]?.value||"(ã‚¿ã‚¤ãƒˆãƒ«ãªã—)",s=document.createElement("a");s.href=`${location.origin}/k/${f}/show#record=${o}`,s.target="_blank",s.textContent=r,s.style.textDecoration="none",s.style.color="#3598db",n.appendChild(s),e.appendChild(n)}),u.innerHTML="",u.appendChild(e)}}catch(e){console.error("é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—ã‚¨ãƒ©ãƒ¼:",e),u.innerHTML=`<p style="color:#c00;">é–¢é€£ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${e.message||JSON.stringify(e)}</p>`}var y;return e}),kintone.events.on("app.record.detail.show",function(e){if(e.appId!==o.TASK_APP_ID)return e;console.log("Task record detail view detected. Preparing to show iframe...");const t=e.record,n=t[r]?.value,s=t[c]?.value,a=i[n];let d="";if(a&&s?d=`${location.origin}/k/${a}/show#record=${s}`:console.log("Required fields for iframe URL are missing (case_type or case_id)."),!d)return console.log("iframe URL is not defined. Skipping iframe creation."),e;const l="custom-iframe-container";let p=document.getElementById(l);if(p)p.innerHTML="";else{p=document.createElement("div"),p.id=l;const t=document.getElementById("record-gaia");if(!t)return console.warn("#record-gaia element not found. Cannot insert iframe container."),e;t.insertAdjacentElement("afterend",p)}const u=document.createElement("iframe");return u.src=d,u.width="100%",u.height="800px",u.style.border="none",e})}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(904)})();